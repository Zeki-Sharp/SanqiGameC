# è§†æ•ˆæ§åˆ¶å™¨ä½¿ç”¨è¯´æ˜

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è§†æ•ˆæ§åˆ¶å™¨æ˜¯ä¸€ä¸ª**åŸºç¡€ç‰¹æ•ˆåº“ + è‡ªç”±ç»„åˆé…ç½®**çš„ç³»ç»Ÿï¼Œé€šè¿‡ScriptableObjecté…ç½®å„ç§ç‰¹æ•ˆç»„åˆï¼Œå®ç°çµæ´»çš„è§†è§‰æ•ˆæœç®¡ç†ã€‚

## ğŸ—ï¸ æ¸…æ™°çš„æ¶æ„å±‚æ¬¡

### **ç¬¬ä¸€å±‚ï¼šåŸºç¡€ç‰¹æ•ˆåº“**
- `FlashEffect` - åŸºç¡€é—ªçƒç‰¹æ•ˆï¼ˆç‹¬ç«‹çš„MonoBehaviourç»„ä»¶ï¼‰
- `KnockbackEffect` - åŸºç¡€å‡»é€€ç‰¹æ•ˆï¼ˆç‹¬ç«‹çš„MonoBehaviourç»„ä»¶ï¼‰
- `ScaleEffect` - åŸºç¡€ç¼©æ”¾ç‰¹æ•ˆï¼ˆç‹¬ç«‹çš„MonoBehaviourç»„ä»¶ï¼‰

### **ç¬¬äºŒå±‚ï¼šç‰¹æ•ˆç»„åˆé…ç½®**
- `EffectConfig` - å•ä¸ªç‰¹æ•ˆçš„é…ç½®æ•°æ®
- `EffectCombination` - ç‰¹æ•ˆç»„åˆï¼ˆå¦‚ï¼šå‡»é€€+é—ªçƒå˜ç™½ï¼‰
- `EffectCombinationPreset` - ç‰¹æ•ˆç»„åˆé¢„è®¾æ–‡ä»¶

### **ç¬¬ä¸‰å±‚ï¼šæ§åˆ¶å™¨**
- `VisualEffectController` - è´Ÿè´£æ’­æ”¾ç‰¹æ•ˆç»„åˆï¼ˆè‡ªåŠ¨æ³¨å†Œåˆ°GameManagerï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æ·»åŠ ç»„ä»¶åˆ°GameObject
- åœ¨éœ€è¦ç‰¹æ•ˆçš„å¯¹è±¡ä¸Šæ·»åŠ  `VisualEffectController` ç»„ä»¶
- é…ç½® `effectPreset` å¼•ç”¨

### 2. åˆ›å»ºç‰¹æ•ˆç»„åˆé¢„è®¾
- åœ¨Projectçª—å£ä¸­å³é”® â†’ Create â†’ Tower Defense â†’ Effect Combination Preset
- é…ç½®å„ç§ç‰¹æ•ˆç»„åˆ

### 3. è‡ªåŠ¨æ’­æ”¾
- å½“å¯¹è±¡å—åˆ°ä¼¤å®³æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ’­æ”¾å¯¹åº”çš„ç‰¹æ•ˆç»„åˆ

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€ç‰¹æ•ˆå‚æ•°
- **é—ªçƒç‰¹æ•ˆ**: intensityï¼ˆå¼ºåº¦ï¼‰ã€frequencyï¼ˆé¢‘ç‡ï¼‰ã€flashColorï¼ˆé¢œè‰²ï¼‰
- **å‡»é€€ç‰¹æ•ˆ**: forceï¼ˆåŠ›åº¦ï¼‰ã€knockbackDurationï¼ˆå‡»é€€æŒç»­æ—¶é—´ï¼‰
- **ç¼©æ”¾ç‰¹æ•ˆ**: targetScaleï¼ˆç›®æ ‡ç¼©æ”¾ï¼‰ã€elasticReturnï¼ˆæ˜¯å¦å¼¹æ€§è¿”å›ï¼‰

### ç‰¹æ•ˆç»„åˆé…ç½®
- **æ•Œäººå—å‡»**: å‡»é€€ + é—ªçƒå˜ç™½
- **å¡”å—å‡»**: é—ªçƒå˜çº¢
- **æŠ€èƒ½ç‰¹æ•ˆ**: é—ªçƒå˜æ©™ + ç¼©æ”¾
- **çŠ¶æ€ç‰¹æ•ˆ**: é—ªçƒå˜ç»¿

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ä½¿ç”¨ï¼ˆæ¨èï¼‰
```csharp
// åœ¨DamageTakerä¸­è‡ªåŠ¨è°ƒç”¨ï¼Œæ— éœ€æ‰‹åŠ¨ä»£ç 
// åªéœ€è¦é…ç½®å¥½VisualEffectControllerå’ŒeffectPresetå³å¯
```

### æ’­æ”¾ç‰¹æ•ˆç»„åˆ
```csharp
// æ’­æ”¾ç‰¹æ•ˆç»„åˆ
visualEffectController.PlayEffect("EnemyHit");
visualEffectController.PlayEffect("TowerHit");
visualEffectController.PlayEffect("Fireball");
```

### æ’­æ”¾è‡ªå®šä¹‰ç»„åˆ
```csharp
// æ’­æ”¾è‡ªå®šä¹‰ç‰¹æ•ˆç»„åˆ
var customCombination = new EffectCombination();
customCombination.effects.Add(new EffectConfig { effectType = EffectType.Flash });
visualEffectController.PlayEffectCombination(customCombination);
```

### è·å–å¯ç”¨ç‰¹æ•ˆ
```csharp
// è·å–æ‰€æœ‰å¯ç”¨çš„ç‰¹æ•ˆç»„åˆåç§°
var availableEffects = visualEffectController.GetAvailableEffects();
foreach (var effectName in availableEffects)
{
    Debug.Log($"å¯ç”¨ç‰¹æ•ˆ: {effectName}");
}
```

## ğŸ“ æ–‡ä»¶ç»“æ„

- `BaseVisualEffect.cs` - åŸºç¡€ç‰¹æ•ˆåŸºç±»å’Œå®ç°
- `EffectCombination.cs` - ç‰¹æ•ˆç»„åˆé…ç½®ç³»ç»Ÿ
- `VisualEffectController.cs` - ä¸»æ§åˆ¶å™¨ï¼ˆè‡ªåŠ¨æ³¨å†Œåˆ°GameManagerï¼‰

## ğŸ”— ç³»ç»Ÿé›†æˆ

### GameManagerç»Ÿä¸€ç®¡ç†
- `VisualEffectController` è‡ªåŠ¨æ³¨å†Œåˆ° `GameManager`
- é€šè¿‡ `GameManager.Instance.VisualEffectController` å…¨å±€è®¿é—®

### ç‰¹æ•ˆç±»å‹æ”¯æŒ
- **åŸºç¡€ç‰¹æ•ˆ**: é—ªçƒã€å‡»é€€ã€ç¼©æ”¾
- **è‡ªç”±ç»„åˆ**: å¯ä»¥ä»»æ„ç»„åˆåŸºç¡€ç‰¹æ•ˆ
- **ç»Ÿä¸€æ¥å£**: æ‰€æœ‰ç‰¹æ•ˆéƒ½é€šè¿‡ `PlayEffect(string combinationName)` è°ƒç”¨

## âš ï¸ æ³¨æ„äº‹é¡¹

1. ç¡®ä¿å¯¹è±¡æœ‰ `SpriteRenderer` ç»„ä»¶ï¼ˆç”¨äºé—ªçƒæ•ˆæœï¼‰
2. æ•Œäººå¯¹è±¡éœ€è¦è®¾ç½® "Enemy" æ ‡ç­¾
3. ç‰¹æ•ˆç»„åˆé¢„è®¾æ–‡ä»¶éœ€è¦æ­£ç¡®é…ç½®
4. åŸºç¡€ç‰¹æ•ˆç»„ä»¶ä¼šè‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ
5. ç³»ç»Ÿè‡ªåŠ¨æ³¨å†Œåˆ° `GameManager`ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†

## ğŸ”® æ‰©å±•æ€§

ç³»ç»Ÿè®¾è®¡ä¸ºé«˜åº¦å¯æ‰©å±•ï¼š
- **æ·»åŠ æ–°åŸºç¡€ç‰¹æ•ˆ**: ç»§æ‰¿ `BaseVisualEffect` å¹¶å®ç°æŠ½è±¡æ–¹æ³•
- **è‡ªç”±ç»„åˆ**: é€šè¿‡é…ç½®ä»»æ„ç»„åˆåŸºç¡€ç‰¹æ•ˆ
- **å‚æ•°é…ç½®**: æ‰€æœ‰ç‰¹æ•ˆå‚æ•°éƒ½å¯ä»¥åœ¨ScriptableObjectä¸­é…ç½®

## ğŸ“ é…ç½®ç¤ºä¾‹

### æ•Œäººå—å‡»æ•ˆæœç»„åˆ
```
combinationName: "EnemyHit"
executionMode: Parallel  // å¹¶è¡Œæ‰§è¡Œï¼šå‡»é€€å’Œé—ªçƒåŒæ—¶å‘ç”Ÿ
effects:
  - effectType: Knockback
    force: 2.0
    knockbackDuration: 0.3
    duration: 0.4
  
  - effectType: Flash
    intensity: 0.8
    frequency: 8
    flashColor: white
    duration: 0.4
```

### å¡”å—å‡»æ•ˆæœç»„åˆ
```
combinationName: "TowerHit"
executionMode: Parallel  // å¹¶è¡Œæ‰§è¡Œï¼šåªæœ‰é—ªçƒæ•ˆæœ
effects:
  - effectType: Flash
    intensity: 0.6
    frequency: 6
    flashColor: red
    duration: 0.3
```

### æŠ€èƒ½ç‰¹æ•ˆç»„åˆï¼ˆé¡ºåºæ‰§è¡Œï¼‰
```
combinationName: "Fireball"
executionMode: Sequential  // é¡ºåºæ‰§è¡Œï¼šå…ˆé—ªçƒï¼Œå†ç¼©æ”¾
effects:
  - effectType: Flash
    intensity: 1.0
    frequency: 12
    flashColor: orange
    duration: 1.0
  
  - effectType: Scale
    targetScale: (1.5, 1.5, 1.5)
    elasticReturn: true
    duration: 1.0
```

## ğŸ¨ é…ç½®æµç¨‹

1. **åˆ›å»ºåŸºç¡€ç‰¹æ•ˆ**: åœ¨GameObjectä¸Šæ·»åŠ åŸºç¡€ç‰¹æ•ˆç»„ä»¶
2. **é…ç½®ç‰¹æ•ˆå‚æ•°**: è°ƒæ•´åŸºç¡€ç‰¹æ•ˆçš„å‚æ•°
3. **åˆ›å»ºç»„åˆé¢„è®¾**: åˆ›å»º `EffectCombinationPreset` æ–‡ä»¶
4. **é…ç½®ç‰¹æ•ˆç»„åˆ**: åœ¨é¢„è®¾ä¸­é…ç½®å„ç§ç‰¹æ•ˆç»„åˆ
5. **åº”ç”¨åˆ°æ§åˆ¶å™¨**: å°†é¢„è®¾åˆ†é…ç»™ `VisualEffectController`
6. **è‡ªåŠ¨æ’­æ”¾**: ç³»ç»Ÿæ ¹æ®é…ç½®è‡ªåŠ¨æ’­æ”¾ç‰¹æ•ˆç»„åˆ

## ğŸ’¡ è®¾è®¡ç†å¿µ

### **ä¸ºä»€ä¹ˆç§»é™¤åˆ†ç±»ï¼Ÿ**
- **åŸºç¡€ç‰¹æ•ˆå¯ä»¥è‡ªç”±ç»„åˆ**ï¼Œåˆ†ç±»æ²¡æœ‰å®é™…æ„ä¹‰
- **ç»Ÿä¸€æ¥å£æ›´ç®€æ´**ï¼Œ`PlayEffect("EffectName")` å³å¯
- **é…ç½®é©±åŠ¨**ï¼Œé€šè¿‡å‘½åçº¦å®šæ¥åŒºåˆ†ç”¨é€”ï¼ˆå¦‚ï¼šEnemyHitã€TowerHitã€Fireballç­‰ï¼‰

### **å‘½åçº¦å®šå»ºè®®**
- `EnemyHit` - æ•Œäººå—å‡»æ•ˆæœ
- `TowerHit` - å¡”å—å‡»æ•ˆæœ  
- `Fireball` - ç«çƒæŠ€èƒ½æ•ˆæœ
- `Poison` - ä¸­æ¯’çŠ¶æ€æ•ˆæœ
- `Heal` - æ²»ç–—æ•ˆæœ

## ğŸ”„ ç‰¹æ•ˆæ‰§è¡Œå…³ç³»è¯¦è§£

### **ä¸€ä¸ªç»„åˆå†…çš„ç‰¹æ•ˆæ‰§è¡Œæ–¹å¼**

#### **å¹¶è¡Œæ‰§è¡Œ (Parallel) - é»˜è®¤æ–¹å¼**
- æ‰€æœ‰ç‰¹æ•ˆåŒæ—¶å¼€å§‹æ‰§è¡Œ
- é€‚åˆï¼šå—å‡»æ•ˆæœï¼ˆå‡»é€€+é—ªçƒåŒæ—¶å‘ç”Ÿï¼‰
- ç¤ºä¾‹ï¼šæ•Œäººå—å‡»æ—¶ï¼Œå‡»é€€å’Œé—ªçƒåŒæ—¶è¿›è¡Œ

#### **é¡ºåºæ‰§è¡Œ (Sequential)**
- ç‰¹æ•ˆæŒ‰é…ç½®é¡ºåºä¾æ¬¡æ‰§è¡Œ
- é€‚åˆï¼šæŠ€èƒ½è¿å‡»ã€çŠ¶æ€å˜åŒ–åºåˆ—
- ç¤ºä¾‹ï¼šç«çƒæŠ€èƒ½å…ˆé—ªçƒï¼Œå†ç¼©æ”¾

### **å¤šä¸ªç»„åˆçš„å…³ç³»**
- **æ¯ä¸ªç»„åˆéƒ½æ˜¯ç‹¬ç«‹è°ƒç”¨çš„**
- **ä¸æ˜¯é¡ºåºæ‰§è¡Œå…³ç³»**
- è°ƒç”¨æ–¹å¼ï¼š
```csharp
// è¿™äº›æ˜¯ç‹¬ç«‹çš„è°ƒç”¨ï¼Œä¸æ˜¯é¡ºåºæ‰§è¡Œ
visualEffectController.PlayEffect("EnemyHit");   // æ‰§è¡ŒEnemyHitç»„åˆ
visualEffectController.PlayEffect("TowerHit");  // æ‰§è¡ŒTowerHitç»„åˆ
```

### **é…ç½®å»ºè®®**
- **å—å‡»æ•ˆæœ**: ä½¿ç”¨ `Parallel` æ‰§è¡Œæ–¹å¼
- **æŠ€èƒ½æ•ˆæœ**: æ ¹æ®éœ€æ±‚é€‰æ‹© `Parallel` æˆ– `Sequential`
- **çŠ¶æ€æ•ˆæœ**: é€šå¸¸ä½¿ç”¨ `Sequential` æ‰§è¡Œæ–¹å¼

## ğŸš¨ é…ç½®æ–‡ä»¶é—®é¢˜æ’æŸ¥

### **å¦‚æœé…ç½®æ–‡ä»¶æ˜¾ç¤º"The associated script can not be loaded"**

1. **æ£€æŸ¥ç¼–è¯‘é”™è¯¯**
   - æŸ¥çœ‹Consoleçª—å£æ˜¯å¦æœ‰ç¼–è¯‘é”™è¯¯
   - ç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½èƒ½æ­£å¸¸ç¼–è¯‘

2. **æ£€æŸ¥è„šæœ¬å¼•ç”¨**
   - ç¡®ä¿ScriptableObjectæ–‡ä»¶å¼•ç”¨äº†æ­£ç¡®çš„è„šæœ¬
   - å¦‚æœè„šæœ¬è¢«é‡å‘½åï¼Œéœ€è¦é‡æ–°åˆ›å»ºScriptableObject

3. **é‡æ–°åˆ›å»ºé…ç½®æ–‡ä»¶**
   - åˆ é™¤æœ‰é—®é¢˜çš„é…ç½®æ–‡ä»¶
   - é‡æ–°åˆ›å»º `Effect Combination Preset`

4. **æ£€æŸ¥æ–‡ä»¶è·¯å¾„**
   - ç¡®ä¿è„šæœ¬æ–‡ä»¶åœ¨æ­£ç¡®çš„ç›®å½•ä¸­
   - æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶é‡å‘½åæˆ–ç§»åŠ¨

è¿™æ ·æ—¢ä¿æŒäº†çµæ´»æ€§ï¼Œåˆé€šè¿‡å‘½åçº¦å®šæä¾›äº†æ¸…æ™°çš„ä½¿ç”¨æŒ‡å¯¼ã€‚
