# 建造系统优化清单（2025.07最新，基于实际代码结构）

## TODO List（核心攻关问题，优先解决）
- [ ] 建造预览中心锚点吸附问题：支持重心/自定义锚点，适配所有形状，鼠标吸附点与视觉中心一致。
- [ ] 建造预览与实际建造的旋转一致性问题：旋转后锚点、坐标、预览与实际完全一致。
- [ ] 预览系统性能优化：减少BlockPreviewSystem.UpdatePreview中的碰撞检测和变色消耗，必要时引入对象池。
- [ ] 事件系统解耦与内存管理：优化EventBus事件参数传递和订阅管理，防止内存泄漏。

---

## 最高优先级（性能与架构基础）
- [ ] 预览系统性能问题：BlockPreviewSystem.UpdatePreview每帧大量碰撞检测和变色，影响帧率。
- [ ] 对象池缺失：预览塔、Block、Tower频繁生成/销毁，GC压力大。
- [ ] 资源加载混乱：Resources.Load路径硬编码，重复加载，资源释放不统一。
- [ ] 事件系统解耦与内存泄漏：EventBus事件参数传递复杂对象，未统一管理，存在泄漏风险。
- [ ] 关键职责分离不彻底：部分脚本（如BlockPlacementManager）仍有输入、预览、建造等多重职责，需进一步拆分。

## 高优先级（结构、工具与规范）
- [ ] 配置验证机制缺失：ScriptableObject配置缺少运行时验证，易导致异常。
- [ ] 编辑器工具不完善：批量创建/修改/预览效率低。
- [ ] 代码重复：建造、生成逻辑重复，维护困难。
- [ ] 注释/未用代码冗余：部分脚本有大量注释和未用字段。
- [ ] 资源路径管理混乱：Resources.Load路径分散，缺少统一管理。
- [ ] 预览与实际建造流程边界不清：showarea与主建造流程部分逻辑耦合，需彻底解耦。

## 中优先级（代码质量与维护）
- [ ] 单例模式优化：GameMap、EventBus等单例实现有改进空间。
- [ ] 可视化调试工具缺失：缺少运行时调试入口。
- [ ] 异常处理不完善：关键方法缺少完整异常处理。
- [ ] 预览系统与UI/输入解耦不足：部分UI逻辑与预览系统耦合，影响扩展性。

## 低优先级/长期维护
- [ ] 代码风格与命名规范进一步统一。
- [ ] 结构性注释和文档补全。
- [ ] 测试代码与主逻辑彻底分离。

---

> 本清单基于当前项目实际代码结构、职责分布和流程梳理，后续如有新问题请持续补充。优先级排序建议：TODO List > 最高优先级 > 高优先级 > 中优先级 > 低优先级。

